(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{286:function(t,e,r){"use strict";r.r(e),function(t){var r;const o="undefined"==typeof window?t:window,n=o.performance&&(()=>o.performance.now())||(()=>Date.now()),h=o.requestAnimationFrame||(t=>setTimeout((()=>t(n())),1e3/60)),l=o.cancelAnimationFrame||clearTimeout;function c(t){return t[t.length-1]}function d(base,t){const output={...base};for(const e in t){const r=base[e],o=t[e];r!==o&&(r&&o&&"object"==typeof r&&"object"==typeof o&&!Array.isArray(o)?output[e]=d(r,o):output[e]=o)}return output}let _=0;function k(){return _++,_}function m(t){return t.reduce(((t,e)=>e+t),0)/t.length}function f(t){const e=t.toUpperCase().trim();if(/^#([A-F0-9]{3}){1,2}$/.test(e)){let t=e.substring(1).split("");3===t.length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]);const r=`${t.join("")}`;return{r:parseInt(r.slice(0,2),16),g:parseInt(r.slice(2,4),16),b:parseInt(r.slice(4,6),16),a:1}}const r=e.match(/^RGBA?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d*\.?\d+))?\)$/);if(r)return{r:parseInt(r[1],10),g:parseInt(r[2],10),b:parseInt(r[3],10),a:parseFloat(r[4]||1,10)};throw new Error(`Invalid color: ${t}`)}function v(t,e){const r={};for(let i=0;i<e;i++)r[i]=t;return r}const y=(null===(r=o.navigator)||void 0===r?void 0:r.userAgent)||"",w=y.indexOf("MSIE ")>0||y.indexOf("Trident/")>0||y.indexOf("Edge/")>0,C=()=>{};class S{constructor(t,e,r=C){this._mutationChains=[],this._onStateChange=r,this.state={options:{drawingFadeDuration:e.drawingFadeDuration,drawingWidth:e.drawingWidth,drawingColor:f(e.drawingColor),strokeColor:f(e.strokeColor),outlineColor:f(e.outlineColor),radicalColor:f(e.radicalColor||e.strokeColor),highlightColor:f(e.highlightColor)},character:{main:{opacity:e.showCharacter?1:0,strokes:{}},outline:{opacity:e.showOutline?1:0,strokes:{}},highlight:{opacity:1,strokes:{}}},userStrokes:null};for(let i=0;i<t.strokes.length;i++)this.state.character.main.strokes[i]={opacity:1,displayPortion:1},this.state.character.outline.strokes[i]={opacity:1,displayPortion:1},this.state.character.highlight.strokes[i]={opacity:0,displayPortion:1}}overwriteOnStateChange(t){this._onStateChange=t}updateState(t){const e=d(this.state,t);this._onStateChange(e,this.state),this.state=e}run(t,e={}){const r=t.map((t=>t.scope));return this.cancelMutations(r),new Promise((o=>{const n={_isActive:!0,_index:0,_resolve:o,_mutations:t,_loop:e.loop,_scopes:r};this._mutationChains.push(n),this._run(n)}))}_run(t){if(!t._isActive)return;const e=t._mutations;if(t._index>=e.length){if(!t._loop)return t._isActive=!1,this._mutationChains=this._mutationChains.filter((e=>e!==t)),void t._resolve({canceled:!1});t._index=0}t._mutations[t._index].run(this).then((()=>{t._isActive&&(t._index++,this._run(t))}))}_getActiveMutations(){return this._mutationChains.map((t=>t._mutations[t._index]))}pauseAll(){this._getActiveMutations().forEach((t=>t.pause()))}resumeAll(){this._getActiveMutations().forEach((t=>t.resume()))}cancelMutations(t){for(const e of this._mutationChains)for(const r of e._scopes)for(const o of t)(r.startsWith(o)||o.startsWith(r))&&this._cancelMutationChain(e)}cancelAll(){this.cancelMutations([""])}_cancelMutationChain(t){var e;t._isActive=!1;for(let i=t._index;i<t._mutations.length;i++)t._mutations[i].cancel(this);null===(e=t._resolve)||void 0===e||e.call(t,{canceled:!0}),this._mutationChains=this._mutationChains.filter((e=>e!==t))}}const P=(t,e)=>({x:t.x-e.x,y:t.y-e.y}),D=t=>Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)),x=(t,e)=>D(P(t,e)),M=(t,e=1)=>{const r=10*e;return{x:Math.round(r*t.x)/r,y:Math.round(r*t.y)/r}},R=t=>{let e=t[0];return t.slice(1).reduce(((t,r)=>{const o=x(r,e);return e=r,t+o}),0)},$=(t,e,r)=>{const o=P(e,t),n=r/D(o);return{x:e.x+n*o.x,y:e.y+n*o.y}},T=t=>{const e=((t,e=30)=>{const r=R(t)/(e-1),o=[t[0]],n=c(t),h=t.slice(1);for(let i=0;i<e-2;i++){let t=c(o),e=r,n=!1;for(;!n;){const r=x(t,h[0]);if(r<e)e-=r,t=h.shift();else{const l=$(t,h[0],e-r);o.push(l),n=!0}}}return o.push(n),o})(t),r={x:m(e.map((t=>t.x))),y:m(e.map((t=>t.y)))},o=e.map((t=>P(t,r))),n=Math.sqrt(m([Math.pow(o[0].x,2)+Math.pow(o[0].y,2),Math.pow(c(o).x,2)+Math.pow(c(o).y,2)]));return((t,e=.05)=>{const r=t.slice(0,1);for(const o of t.slice(1)){const t=r[r.length-1],n=x(o,t);if(n>e){const h=Math.ceil(n/e),l=n/h;for(let i=0;i<h;i++)r.push($(o,t,-1*l*(i+1)))}else r.push(o)}return r})(o.map((t=>({x:t.x/n,y:t.y/n}))))};function A(t,e=!1){const r=M(t[0]),o=t.slice(1);let n=`M ${r.x} ${r.y}`;return o.forEach((t=>{const e=M(t);n+=` L ${e.x} ${e.y}`})),e&&(n+="Z"),n}const O=(t,e)=>{const r=(t=>{if(t.length<3)return t;const e=[t[0],t[1]];return t.slice(2).forEach((t=>{const r=e.length,o=P(t,e[r-1]),n=P(e[r-1],e[r-2]);o.y*n.x-o.x*n.y==0&&e.pop(),e.push(t)})),e})(t);if(r.length<2)return r;const o=r[1],n=r[0],h=$(o,n,e),l=r.slice(1);return l.unshift(h),l};class L{constructor(path,t,e,r=!1){this.path=path,this.points=t,this.strokeNum=e,this.isInRadical=r}getStartingPoint(){return this.points[0]}getEndingPoint(){return this.points[this.points.length-1]}getLength(){return R(this.points)}getVectors(){let t=this.points[0];return this.points.slice(1).map((e=>{const r=P(e,t);return t=e,r}))}getDistance(t){const e=this.points.map((e=>x(e,t)));return Math.min(...e)}getAverageDistance(t){return t.reduce(((t,e)=>t+this.getDistance(e)),0)/t.length}}class E{constructor(symbol,t){this.symbol=symbol,this.strokes=t}}function z({radStrokes:t,strokes:e,medians:r}){return e.map(((path,e)=>{const o=r[e].map((t=>{const[e,r]=t;return{x:e,y:r}}));return new L(path,o,e,(n=e,(null!==(h=null==t?void 0:t.indexOf(n))&&void 0!==h?h:-1)>=0));var n,h}))}const[W,F]=[{x:0,y:-124},{x:1024,y:900}],H=F.x-W.x,I=F.y-W.y;class B{constructor(t){const{padding:e,width:r,height:o}=t;this.padding=e,this.width=r,this.height=o;const n=r-2*e,h=o-2*e,l=n/H,c=h/I;this.scale=Math.min(l,c);const d=e+(n-this.scale*H)/2,_=e+(h-this.scale*I)/2;this.xOffset=-1*W.x*this.scale+d,this.yOffset=-1*W.y*this.scale+_}convertExternalPoint(t){return{x:(t.x-this.xOffset)/this.scale,y:(this.height-this.yOffset-t.y)/this.scale}}}const N=(t,e)=>{const r=(t=>{const e=[];let r=t[0];return t.slice(1).forEach((t=>{e.push(P(t,r)),r=t})),e})(t),o=e.getVectors();return m(r.map((t=>{const e=o.map((e=>{return o=t,((r=e).x*o.x+r.y*o.y)/D(r)/D(o);var r,o}));return Math.max(...e)})))>0},j=t=>{if(t.length<2)return t;const[e,...r]=t,o=[e];for(const t of r)n=t,h=o[o.length-1],(n.x!==h.x||n.y!==h.y)&&o.push(t);var n,h;return o},U=[Math.PI/16,Math.PI/32,0,-1*Math.PI/32,-1*Math.PI/16],V=(t,e,r)=>{const o=T(t),n=T(e);let h=1/0;return U.forEach((t=>{const e=((t,e)=>{const r=t.length>=e.length?t:e,o=t.length>=e.length?e:t,n=(i,t,e,n)=>{if(0===i&&0===t)return x(r[0],o[0]);if(i>0&&0===t)return Math.max(e[0],x(r[i],o[0]));const h=n[n.length-1];return 0===i&&t>0?Math.max(h,x(r[0],o[t])):Math.max(Math.min(e[t],e[t-1],h),x(r[i],o[t]))};let h=[];for(let i=0;i<r.length;i++){const t=[];for(let e=0;e<o.length;e++)t.push(n(i,e,h,t));h=t}return h[o.length-1]})(o,((t,e)=>t.map((t=>({x:Math.cos(e)*t.x-Math.sin(e)*t.y,y:Math.sin(e)*t.x+Math.cos(e)*t.y}))))(n,t));e<h&&(h=e)})),h<=.4*r},Q=(t,e,r)=>{const{leniency:o=1,isOutlineVisible:n=!1,checkBackwards:h=!0}=r,l=e.getAverageDistance(t),c=l<=350*(n||e.strokeNum>0?.5:1)*o;if(!c)return{isMatch:!1,avgDist:l,meta:{isStrokeBackwards:!1}};const d=((t,e,r)=>{const o=x(e.getStartingPoint(),t[0]),n=x(e.getEndingPoint(),t[t.length-1]);return o<=250*r&&n<=250*r})(t,e,o),_=N(t,e),k=V(t,e.points,o),m=((t,e,r)=>r*(R(t)+25)/(e.getLength()+25)>=.35)(t,e,o),f=c&&d&&_&&k&&m;if(h&&!f){if(Q([...t].reverse(),e,{...r,checkBackwards:!1}).isMatch)return{isMatch:f,avgDist:l,meta:{isStrokeBackwards:!0}}}return{isMatch:f,avgDist:l,meta:{isStrokeBackwards:!1}}};class G{constructor(t,e,r){this.id=t,this.points=[e],this.externalPoints=[r]}appendPoint(t,e){this.points.push(t),this.externalPoints.push(e)}}class J{constructor(t,e,r={}){this._tick=t=>{if(null!==this._startPauseTime)return;const progress=Math.min(1,(t-this._startTime-this._pausedDuration)/this._duration);if(1===progress)this._renderState.updateState(this._values),this._frameHandle=void 0,this.cancel(this._renderState);else{const t=Y(progress),e=X(this._startState,this._values,t);this._renderState.updateState(e),this._frameHandle=h(this._tick)}},this.scope=t,this._valuesOrCallable=e,this._duration=r.duration||0,this._force=r.force,this._pausedDuration=0,this._startPauseTime=null}run(t){return this._values||this._inflateValues(t),0===this._duration&&t.updateState(this._values),0===this._duration||K(t.state,this._values)?Promise.resolve():(this._renderState=t,this._startState=t.state,this._startTime=performance.now(),this._frameHandle=h(this._tick),new Promise((t=>{this._resolve=t})))}_inflateValues(t){let e=this._valuesOrCallable;"function"==typeof this._valuesOrCallable&&(e=this._valuesOrCallable(t.state)),this._values=function(t,e){const r=t.split("."),o={};let n=o;for(let i=0;i<r.length;i++){const t=i===r.length-1?e:{};n[r[i]]=t,n=t}return o}(this.scope,e)}pause(){null===this._startPauseTime&&(this._frameHandle&&l(this._frameHandle),this._startPauseTime=performance.now())}resume(){null!==this._startPauseTime&&(this._frameHandle=h(this._tick),this._pausedDuration+=performance.now()-this._startPauseTime,this._startPauseTime=null)}cancel(t){var e;null===(e=this._resolve)||void 0===e||e.call(this),this._resolve=void 0,l(this._frameHandle||-1),this._frameHandle=void 0,this._force&&(this._values||this._inflateValues(t),t.updateState(this._values))}}function X(t,e,progress){const r={};for(const o in e){const n=e[o],h=null==t?void 0:t[o];r[o]="number"==typeof h&&"number"==typeof n&&n>=0?progress*(n-h)+h:X(h,n,progress)}return r}function K(t,e){for(const r in e){const o=e[r],n=null==t?void 0:t[r];if(o>=0){if(o!==n)return!1}else if(!K(n,o))return!1}return!0}J.Delay=class{constructor(t){this._duration=t,this._startTime=null,this._paused=!1,this.scope=`delay.${t}`}run(){return this._startTime=n(),this._runningPromise=new Promise((t=>{this._resolve=t,this._timeout=setTimeout((()=>this.cancel()),this._duration)})),this._runningPromise}pause(){if(this._paused)return;const t=performance.now()-(this._startTime||0);this._duration=Math.max(0,this._duration-t),clearTimeout(this._timeout),this._paused=!0}resume(){this._paused&&(this._startTime=performance.now(),this._timeout=setTimeout((()=>this.cancel()),this._duration),this._paused=!1)}cancel(){clearTimeout(this._timeout),this._resolve&&this._resolve(),this._resolve=void 0}};const Y=t=>-Math.cos(t*Math.PI)/2+.5,Z=(t,e,r)=>[new J(`character.${t}.strokes`,v({opacity:1,displayPortion:1},e.strokes.length),{duration:r,force:!0})],tt=(t,e,r)=>[new J(`character.${t}`,{opacity:1,strokes:v({opacity:1,displayPortion:1},e.strokes.length)},{duration:r,force:!0})],et=(t,e,r)=>[new J(`character.${t}.opacity`,0,{duration:r,force:!0}),...Z(t,e,0)],it=(t,e,r)=>[new J(`options.${t}`,e,{duration:r})],st=(t,e,r)=>{const o=t.strokeNum,n=(t.getLength()+600)/(3*r);return[new J("character.highlight.strokeColor",e),new J("character.highlight",{opacity:1,strokes:{[o]:{displayPortion:0,opacity:0}}}),new J(`character.highlight.strokes.${o}`,{displayPortion:1,opacity:1},{duration:n}),new J(`character.highlight.strokes.${o}.opacity`,0,{duration:n})]},ot=(t,e,r)=>{const o=e.strokeNum,n=(e.getLength()+600)/(3*r);return[new J(`character.${t}`,{opacity:1,strokes:{[o]:{displayPortion:0,opacity:1}}}),new J(`character.${t}.strokes.${o}.displayPortion`,1,{duration:n})]},nt=(t,e,r,o,n)=>{let h=et(t,e,r);return h=h.concat(Z(t,e,0)),h.push(new J(`character.${t}`,{opacity:1,strokes:v({opacity:0},e.strokes.length)},{force:!0})),e.strokes.forEach(((e,i)=>{i>0&&h.push(new J.Delay(n)),h=h.concat(ot(t,e,o))})),h},at=(t,e)=>[new J(`userStrokes.${t}.opacity`,0,{duration:e}),new J(`userStrokes.${t}`,null,{force:!0})];class ht{constructor(t,e,r){this._currentStrokeIndex=0,this._mistakesOnStroke=0,this._totalMistakes=0,this._character=t,this._renderState=e,this._isActive=!1,this._positioner=r}startQuiz(t){return this._isActive=!0,this._options=t,this._currentStrokeIndex=0,this._mistakesOnStroke=0,this._totalMistakes=0,this._renderState.run((e=this._character,r=t.strokeFadeDuration,[...et("main",e,r),new J("character.highlight",{opacity:1,strokes:v({opacity:0},e.strokes.length)},{force:!0}),new J("character.main",{opacity:1,strokes:v({opacity:0},e.strokes.length)},{force:!0})]));var e,r}startUserStroke(t){if(!this._isActive)return null;if(this._userStroke)return this.endUserStroke();const e=this._positioner.convertExternalPoint(t),r=k();return this._userStroke=new G(r,e,t),this._renderState.run(((t,e)=>[new J("quiz.activeUserStrokeId",t,{force:!0}),new J(`userStrokes.${t}`,{points:[e],opacity:1},{force:!0})])(r,e))}continueUserStroke(t){if(!this._userStroke)return Promise.resolve();const e=this._positioner.convertExternalPoint(t);this._userStroke.appendPoint(e,t);const r=this._userStroke.points.slice(0);return this._renderState.run((o=this._userStroke.id,[new J(`userStrokes.${o}.points`,r,{force:!0})]));var o}setPositioner(t){this._positioner=t}endUserStroke(){var t;if(!this._userStroke)return;if(this._renderState.run(at(this._userStroke.id,null!==(t=this._options.drawingFadeDuration)&&void 0!==t?t:300)),1===this._userStroke.points.length)return void(this._userStroke=void 0);const{acceptBackwardsStrokes:e}=this._options,r=this._getCurrentStroke(),{isMatch:o,meta:meta}=function(t,e,r,o={}){const n=e.strokes,h=j(t.points);if(h.length<2)return{isMatch:!1,meta:{isStrokeBackwards:!1}};const{isMatch:l,meta:meta,avgDist:c}=Q(h,n[r],o);if(!l)return{isMatch:l,meta:meta};const d=n.slice(r+1);let _=c;for(let i=0;i<d.length;i++){const{isMatch:t,avgDist:e}=Q(h,d[i],{...o,checkBackwards:!1});t&&e<_&&(_=e)}if(_<c){const t=.6*(_+c)/(2*c),{isMatch:e,meta:meta}=Q(h,n[r],{...o,leniency:(o.leniency||1)*t});return{isMatch:e,meta:meta}}return{isMatch:l,meta:meta}}(this._userStroke,this._character,this._currentStrokeIndex,{isOutlineVisible:this._renderState.state.character.outline.opacity>0,leniency:this._options.leniency});if(o||meta.isStrokeBackwards&&e)this._handleSuccess(meta);else{this._handleFailure(meta);const{showHintAfterMisses:t,highlightColor:e,strokeHighlightSpeed:o}=this._options;!1!==t&&this._mistakesOnStroke>=t&&this._renderState.run(st(r,f(e),o))}this._userStroke=void 0}cancel(){this._isActive=!1,this._userStroke&&this._renderState.run(at(this._userStroke.id,this._options.drawingFadeDuration))}_getStrokeData({isCorrect:t,meta:meta}){return{character:this._character.symbol,strokeNum:this._currentStrokeIndex,mistakesOnStroke:this._mistakesOnStroke,totalMistakes:this._totalMistakes,strokesRemaining:this._character.strokes.length-this._currentStrokeIndex-(t?1:0),drawnPath:(e=this._userStroke,{pathString:A(e.externalPoints),points:e.points.map((t=>M(t)))}),isBackwards:meta.isStrokeBackwards};var e}_handleSuccess(meta){if(!this._options)return;const{strokes:t,symbol:symbol}=this._character,{onCorrectStroke:e,onComplete:r,highlightOnComplete:o,strokeFadeDuration:n,strokeHighlightDuration:h}=this._options;null==e||e({...this._getStrokeData({isCorrect:!0,meta:meta})});let l=(c="main",d=this._currentStrokeIndex,[new J(`character.${c}.strokes.${d}`,{displayPortion:1,opacity:1},{duration:n,force:!0})]);var c,d;this._mistakesOnStroke=0,this._currentStrokeIndex+=1;this._currentStrokeIndex===t.length&&(this._isActive=!1,null==r||r({character:symbol,totalMistakes:this._totalMistakes}),o&&(l=l.concat(((t,e)=>[...et("highlight",t),...tt("highlight",t,e/2),...et("highlight",t,e/2)])(this._character,2*(h||0))))),this._renderState.run(l)}_handleFailure(meta){var t,e;this._mistakesOnStroke+=1,this._totalMistakes+=1,null===(t=(e=this._options).onMistake)||void 0===t||t.call(e,this._getStrokeData({isCorrect:!1,meta:meta}))}_getCurrentStroke(){return this._character.strokes[this._currentStrokeIndex]}}function lt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ct(t,e,r){t.setAttributeNS(null,e,r)}function ut(t,e){Object.keys(e).forEach((r=>ct(t,r,e[r])))}function _t(t){var e;null==t||null===(e=t.parentNode)||void 0===e||e.removeChild(t)}class pt{constructor(t){this.stroke=t,this._pathLength=t.getLength()+pt.STROKE_WIDTH/2}_getStrokeDashoffset(t){return.999*this._pathLength*(1-t)}_getColor({strokeColor:t,radicalColor:e}){return e&&this.stroke.isInRadical?e:t}}pt.STROKE_WIDTH=200;class gt extends pt{constructor(t){super(t),this._oldProps=void 0}mount(t){this._animationPath=lt("path"),this._clip=lt("clipPath"),this._strokePath=lt("path");const e=`mask-${k()}`;ct(this._clip,"id",e),ct(this._strokePath,"d",this.stroke.path),this._animationPath.style.opacity="0",ct(this._animationPath,"clip-path",function(t){let e="";return window.location&&window.location.href&&(e=window.location.href.replace(/#[^#]*$/,"").replace(/"/gi,"%22")),`url("${e}#${t}")`}(e));const r=O(this.stroke.points,100);return ct(this._animationPath,"d",A(r)),ut(this._animationPath,{stroke:"#FFFFFF","stroke-width":200..toString(),fill:"none","stroke-linecap":"round","stroke-linejoin":"miter","stroke-dasharray":`${this._pathLength},${this._pathLength}`}),this._clip.appendChild(this._strokePath),t.defs.appendChild(this._clip),t.svg.appendChild(this._animationPath),this}render(t){var e,r;if(t===this._oldProps||!this._animationPath)return;t.displayPortion!==(null===(e=this._oldProps)||void 0===e?void 0:e.displayPortion)&&(this._animationPath.style.strokeDashoffset=this._getStrokeDashoffset(t.displayPortion).toString());const o=this._getColor(t);if(!this._oldProps||o!==this._getColor(this._oldProps)){const{r:t,g:g,b:b,a:a}=o;ut(this._animationPath,{stroke:`rgba(${t},${g},${b},${a})`})}t.opacity!==(null===(r=this._oldProps)||void 0===r?void 0:r.opacity)&&(this._animationPath.style.opacity=t.opacity.toString()),this._oldProps=t}}class kt{constructor(t){this._oldProps=void 0,this._strokeRenderers=t.strokes.map((t=>new gt(t)))}mount(t){const e=t.createSubRenderTarget();this._group=e.svg,this._strokeRenderers.forEach((t=>{t.mount(e)}))}render(t){var e,r;if(t===this._oldProps||!this._group)return;const{opacity:o,strokes:n,strokeColor:h,radicalColor:l=null}=t;var c;o!==(null===(e=this._oldProps)||void 0===e?void 0:e.opacity)&&(this._group.style.opacity=o.toString(),w||(0===o?this._group.style.display="none":0===(null===(c=this._oldProps)||void 0===c?void 0:c.opacity)&&this._group.style.removeProperty("display")));const d=!this._oldProps||h!==this._oldProps.strokeColor||l!==this._oldProps.radicalColor;if(d||n!==(null===(r=this._oldProps)||void 0===r?void 0:r.strokes))for(let i=0;i<this._strokeRenderers.length;i++){var _;!d&&null!==(_=this._oldProps)&&void 0!==_&&_.strokes&&n[i]===this._oldProps.strokes[i]||this._strokeRenderers[i].render({strokeColor:h,radicalColor:l,opacity:n[i].opacity,displayPortion:n[i].displayPortion})}this._oldProps=t}}class mt{constructor(){this._oldProps=void 0}mount(t){this._path=lt("path"),t.svg.appendChild(this._path)}render(t){var e,r,o,n;if(this._path&&t!==this._oldProps){if(t.strokeColor!==(null===(e=this._oldProps)||void 0===e?void 0:e.strokeColor)||t.strokeWidth!==(null===(r=this._oldProps)||void 0===r?void 0:r.strokeWidth)){const{r:e,g:g,b:b,a:a}=t.strokeColor;ut(this._path,{fill:"none",stroke:`rgba(${e},${g},${b},${a})`,"stroke-width":t.strokeWidth.toString(),"stroke-linecap":"round","stroke-linejoin":"round"})}t.opacity!==(null===(o=this._oldProps)||void 0===o?void 0:o.opacity)&&ct(this._path,"opacity",t.opacity.toString()),t.points!==(null===(n=this._oldProps)||void 0===n?void 0:n.points)&&ct(this._path,"d",A(t.points)),this._oldProps=t}}destroy(){_t(this._path)}}class ft{constructor(t){this.node=t}addPointerStartListener(t){this.node.addEventListener("mousedown",(e=>{t(this._eventify(e,this._getMousePoint))})),this.node.addEventListener("touchstart",(e=>{t(this._eventify(e,this._getTouchPoint))}))}addPointerMoveListener(t){this.node.addEventListener("mousemove",(e=>{t(this._eventify(e,this._getMousePoint))})),this.node.addEventListener("touchmove",(e=>{t(this._eventify(e,this._getTouchPoint))}))}addPointerEndListener(t){document.addEventListener("mouseup",t),document.addEventListener("touchend",t)}getBoundingClientRect(){return this.node.getBoundingClientRect()}updateDimensions(t,e){this.node.setAttribute("width",`${t}`),this.node.setAttribute("height",`${e}`)}_eventify(t,e){return{getPoint:()=>e.call(this,t),preventDefault:()=>t.preventDefault()}}_getMousePoint(t){const{left:e,top:r}=this.getBoundingClientRect();return{x:t.clientX-e,y:t.clientY-r}}_getTouchPoint(t){const{left:e,top:r}=this.getBoundingClientRect();return{x:t.touches[0].clientX-e,y:t.touches[0].clientY-r}}}class vt extends ft{constructor(svg,defs){super(svg),this.svg=svg,this.defs=defs,"createSVGPoint"in svg&&(this._pt=svg.createSVGPoint())}static init(t,e="100%",r="100%"){const element="string"==typeof t?document.getElementById(t):t;if(!element)throw new Error(`HanziWriter target element not found: ${t}`);const o=element.nodeName.toUpperCase(),svg=(()=>{if("SVG"===o||"G"===o)return element;{const svg=lt("svg");return element.appendChild(svg),svg}})();ut(svg,{width:e,height:r});const defs=lt("defs");return svg.appendChild(defs),new vt(svg,defs)}createSubRenderTarget(){const t=lt("g");return this.svg.appendChild(t),new vt(t,this.defs)}_getMousePoint(t){if(this._pt&&(this._pt.x=t.clientX,this._pt.y=t.clientY,"getScreenCTM"in this.node)){var e;const t=this._pt.matrixTransform(null===(e=this.node.getScreenCTM())||void 0===e?void 0:e.inverse());return{x:t.x,y:t.y}}return super._getMousePoint.call(this,t)}_getTouchPoint(t){if(this._pt&&(this._pt.x=t.touches[0].clientX,this._pt.y=t.touches[0].clientY,"getScreenCTM"in this.node)){var e;const t=this._pt.matrixTransform(null===(e=this.node.getScreenCTM())||void 0===e?void 0:e.inverse());return{x:t.x,y:t.y}}return super._getTouchPoint(t)}}var yt={HanziWriterRenderer:class{constructor(t,e){this._character=t,this._positioner=e,this._mainCharRenderer=new kt(t),this._outlineCharRenderer=new kt(t),this._highlightCharRenderer=new kt(t),this._userStrokeRenderers={}}mount(t){const e=t.createSubRenderTarget(),r=e.svg,{xOffset:o,yOffset:n,height:h,scale:l}=this._positioner;ct(r,"transform",`translate(${o}, ${h-n}) scale(${l}, ${-1*l})`),this._outlineCharRenderer.mount(e),this._mainCharRenderer.mount(e),this._highlightCharRenderer.mount(e),this._positionedTarget=e}render(t){const{main:main,outline:e,highlight:r}=t.character,{outlineColor:o,radicalColor:n,highlightColor:h,strokeColor:l,drawingWidth:c,drawingColor:d}=t.options;this._outlineCharRenderer.render({opacity:e.opacity,strokes:e.strokes,strokeColor:o}),this._mainCharRenderer.render({opacity:main.opacity,strokes:main.strokes,strokeColor:l,radicalColor:n}),this._highlightCharRenderer.render({opacity:r.opacity,strokes:r.strokes,strokeColor:h});const _=t.userStrokes||{};for(const t in this._userStrokeRenderers){var k;if(!_[t])null===(k=this._userStrokeRenderers[t])||void 0===k||k.destroy(),delete this._userStrokeRenderers[t]}for(const t in _){const e=_[t];if(!e)continue;const r={strokeWidth:c,strokeColor:d,...e};(()=>{if(this._userStrokeRenderers[t])return this._userStrokeRenderers[t];const e=new mt;return e.mount(this._positionedTarget),this._userStrokeRenderers[t]=e,e})().render(r)}}destroy(){_t(this._positionedTarget.svg),this._positionedTarget.defs.innerHTML=""}},createRenderTarget:vt.init};const wt=(t,e)=>{t.beginPath();const r=e[0],o=e.slice(1);t.moveTo(r.x,r.y);for(const e of o)t.lineTo(e.x,e.y);t.stroke()};class Ct extends pt{constructor(t,e=!0){super(t),e&&Path2D?this._path2D=new Path2D(this.stroke.path):this._pathCmd=(t=>{const e=t.split(/(^|\s+)(?=[A-Z])/).filter((t=>" "!==t)),r=[t=>t.beginPath()];for(const t of e){const[e,...o]=t.split(/\s+/),n=o.map((param=>parseFloat(param)));"M"===e?r.push((t=>t.moveTo(...n))):"L"===e?r.push((t=>t.lineTo(...n))):"C"===e?r.push((t=>t.bezierCurveTo(...n))):"Q"===e&&r.push((t=>t.quadraticCurveTo(...n)))}return t=>r.forEach((e=>e(t)))})(this.stroke.path),this._extendedMaskPoints=O(this.stroke.points,pt.STROKE_WIDTH/2)}render(t,e){if(e.opacity<.05)return;var r;(t.save(),this._path2D)?t.clip(this._path2D):(null===(r=this._pathCmd)||void 0===r||r.call(this,t),t.globalAlpha=0,t.stroke(),t.clip());const{r:o,g:g,b:b,a:a}=this._getColor(e),n=1===a?`rgb(${o},${g},${b})`:`rgb(${o},${g},${b},${a})`,h=this._getStrokeDashoffset(e.displayPortion);t.globalAlpha=e.opacity,t.strokeStyle=n,t.fillStyle=n,t.lineWidth=pt.STROKE_WIDTH,t.lineCap="round",t.lineJoin="round",t.setLineDash([this._pathLength,this._pathLength],h),t.lineDashOffset=h,wt(t,this._extendedMaskPoints),t.restore()}}class St{constructor(t){this._strokeRenderers=t.strokes.map((t=>new Ct(t)))}render(t,e){if(e.opacity<.05)return;const{opacity:r,strokeColor:o,radicalColor:n,strokes:h}=e;for(let i=0;i<this._strokeRenderers.length;i++)this._strokeRenderers[i].render(t,{strokeColor:o,radicalColor:n,opacity:h[i].opacity*r,displayPortion:h[i].displayPortion||0})}}function Pt(t,e){if(e.opacity<.05)return;const{opacity:r,strokeWidth:o,strokeColor:n,points:h}=e,{r:l,g:g,b:b,a:a}=n;t.save(),t.globalAlpha=r,t.lineWidth=o,t.strokeStyle=`rgba(${l},${g},${b},${a})`,t.lineCap="round",t.lineJoin="round",wt(t,h),t.restore()}class Dt extends ft{constructor(canvas){super(canvas)}static init(t,e="100%",r="100%"){const element="string"==typeof t?document.getElementById(t):t;if(!element)throw new Error(`HanziWriter target element not found: ${t}`);const o=element.nodeName.toUpperCase(),canvas=(()=>{if("CANVAS"===o)return element;const canvas=document.createElement("canvas");return element.appendChild(canvas),canvas})();return canvas.setAttribute("width",e),canvas.setAttribute("height",r),new Dt(canvas)}getContext(){return this.node.getContext("2d")}}var xt={HanziWriterRenderer:class{constructor(t,e){this.destroy=C,this._character=t,this._positioner=e,this._mainCharRenderer=new St(t),this._outlineCharRenderer=new St(t),this._highlightCharRenderer=new St(t)}mount(t){this._target=t}_animationFrame(t){const{width:e,height:r,scale:o,xOffset:n,yOffset:h}=this._positioner,l=this._target.getContext();l.clearRect(0,0,e,r),l.save(),l.translate(n,r-h),l.transform(1,0,0,-1,0,0),l.scale(o,o),t(l),l.restore(),l.draw&&l.draw()}render(t){const{outline:e,main:main,highlight:r}=t.character,{outlineColor:o,strokeColor:n,radicalColor:h,highlightColor:l,drawingColor:c,drawingWidth:d}=t.options;this._animationFrame((_=>{this._outlineCharRenderer.render(_,{opacity:e.opacity,strokes:e.strokes,strokeColor:o}),this._mainCharRenderer.render(_,{opacity:main.opacity,strokes:main.strokes,strokeColor:n,radicalColor:h}),this._highlightCharRenderer.render(_,{opacity:r.opacity,strokes:r.strokes,strokeColor:l});const k=t.userStrokes||{};for(const t in k){const e=k[t];if(e){Pt(_,{strokeWidth:d,strokeColor:c,...e})}}}))}},createRenderTarget:Dt.init};const Mt={charDataLoader:(t,e,r)=>{const o=new XMLHttpRequest;o.overrideMimeType&&o.overrideMimeType("application/json"),o.open("GET",(t=>`https://cdn.jsdelivr.net/npm/hanzi-writer-data@2.0/${t}.json`)(t),!0),o.onerror=t=>{r(o,t)},o.onreadystatechange=()=>{4===o.readyState&&(200===o.status?e(JSON.parse(o.responseText)):0!==o.status&&r&&r(o))},o.send(null)},onLoadCharDataError:null,onLoadCharDataSuccess:null,showOutline:!0,showCharacter:!0,renderer:"svg",width:0,height:0,padding:20,strokeAnimationSpeed:1,strokeFadeDuration:400,strokeHighlightDuration:200,strokeHighlightSpeed:2,delayBetweenStrokes:1e3,delayBetweenLoops:2e3,strokeColor:"#555",radicalColor:null,highlightColor:"#AAF",outlineColor:"#DDD",drawingColor:"#333",leniency:1,showHintAfterMisses:3,highlightOnComplete:!0,highlightCompleteColor:null,acceptBackwardsStrokes:!1,drawingFadeDuration:300,drawingWidth:4,strokeWidth:2,outlineWidth:2,rendererOverride:{}};class Rt{constructor(t){this._loadCounter=0,this._isLoading=!1,this.loadingFailed=!1,this._options=t}_debouncedLoad(t,e){const r=data=>{var t;e===this._loadCounter&&(null===(t=this._resolve)||void 0===t||t.call(this,data))},o=t=>{var r;e===this._loadCounter&&(null===(r=this._reject)||void 0===r||r.call(this,t))},n=this._options.charDataLoader(t,r,o);n&&("then"in n?n.then(r).catch(o):r(n))}_setupLoadingPromise(){return new Promise(((t,e)=>{this._resolve=t,this._reject=e})).then((data=>{var t,e;return this._isLoading=!1,null===(t=(e=this._options).onLoadCharDataSuccess)||void 0===t||t.call(e,data),data})).catch((t=>{if(this._isLoading=!1,this.loadingFailed=!0,this._options.onLoadCharDataError)return void this._options.onLoadCharDataError(t);if(t instanceof Error)throw t;const e=new Error(`Failed to load char data for ${this._loadingChar}`);throw e.reason=t,e}))}loadCharData(t){this._loadingChar=t;const e=this._setupLoadingPromise();return this.loadingFailed=!1,this._isLoading=!0,this._loadCounter++,this._debouncedLoad(t,this._loadCounter),e}}class $t{constructor(element,t={}){const{HanziWriterRenderer:e,createRenderTarget:r}="canvas"===t.renderer?xt:yt,o=t.rendererOverride||{};this._renderer={HanziWriterRenderer:o.HanziWriterRenderer||e,createRenderTarget:o.createRenderTarget||r},this.target=this._renderer.createRenderTarget(element,t.width,t.height),this._options=this._assignOptions(t),this._loadingManager=new Rt(this._options),this._setupListeners()}static create(element,t,e){const r=new $t(element,e);return r.setCharacter(t),r}static loadCharacterData(t,e={}){const r=(()=>{const{_loadingManager:r,_loadingOptions:o}=$t;return(null==r?void 0:r._loadingChar)===t&&o===e?r:new Rt({...Mt,...e})})();return $t._loadingManager=r,$t._loadingOptions=e,r.loadCharData(t)}static getScalingTransform(t,e,r=0){const o=new B({width:t,height:e,padding:r});return{x:o.xOffset,y:o.yOffset,scale:o.scale,transform:(n=`\n        translate(${o.xOffset}, ${o.height-o.yOffset})\n        scale(${o.scale}, ${-1*o.scale})\n      `,n.replace(/^\s+/,"").replace(/\s+$/,"")).replace(/\s+/g," ")};var n}showCharacter(t={}){return this._options.showCharacter=!0,this._withData((()=>{var e;return null===(e=this._renderState)||void 0===e?void 0:e.run(tt("main",this._character,"number"==typeof t.duration?t.duration:this._options.strokeFadeDuration)).then((e=>{var r;return null===(r=t.onComplete)||void 0===r||r.call(t,e),e}))}))}hideCharacter(t={}){return this._options.showCharacter=!1,this._withData((()=>{var e;return null===(e=this._renderState)||void 0===e?void 0:e.run(et("main",this._character,"number"==typeof t.duration?t.duration:this._options.strokeFadeDuration)).then((e=>{var r;return null===(r=t.onComplete)||void 0===r||r.call(t,e),e}))}))}animateCharacter(t={}){return this.cancelQuiz(),this._withData((()=>{var e;return null===(e=this._renderState)||void 0===e?void 0:e.run(nt("main",this._character,this._options.strokeFadeDuration,this._options.strokeAnimationSpeed,this._options.delayBetweenStrokes)).then((e=>{var r;return null===(r=t.onComplete)||void 0===r||r.call(t,e),e}))}))}animateStroke(t,e={}){return this.cancelQuiz(),this._withData((()=>{var r;return null===(r=this._renderState)||void 0===r?void 0:r.run(((t,e,r,o)=>{const n=e.strokes[r];return[new J(`character.${t}`,(r=>{const o=r.character[t],n={opacity:1,strokes:{}};for(let i=0;i<e.strokes.length;i++)n.strokes[i]={opacity:o.opacity*o.strokes[i].opacity};return n})),...ot(t,n,o)]})("main",this._character,t,this._options.strokeAnimationSpeed)).then((t=>{var r;return null===(r=e.onComplete)||void 0===r||r.call(e,t),t}))}))}highlightStroke(t,e={}){return this._withData((()=>{if(this._character&&this._renderState)return this._renderState.run(st(this._character.strokes[t],f(this._options.highlightColor),this._options.strokeHighlightSpeed)).then((t=>{var r;return null===(r=e.onComplete)||void 0===r||r.call(e,t),t}))}))}async loopCharacterAnimation(){return this.cancelQuiz(),this._withData((()=>this._renderState.run(((t,e,r,o,n,h)=>{const l=nt(t,e,r,o,n);return l.push(new J.Delay(h)),l})("main",this._character,this._options.strokeFadeDuration,this._options.strokeAnimationSpeed,this._options.delayBetweenStrokes,this._options.delayBetweenLoops),{loop:!0})))}pauseAnimation(){return this._withData((()=>{var t;return null===(t=this._renderState)||void 0===t?void 0:t.pauseAll()}))}resumeAnimation(){return this._withData((()=>{var t;return null===(t=this._renderState)||void 0===t?void 0:t.resumeAll()}))}showOutline(t={}){return this._options.showOutline=!0,this._withData((()=>{var e;return null===(e=this._renderState)||void 0===e?void 0:e.run(tt("outline",this._character,"number"==typeof t.duration?t.duration:this._options.strokeFadeDuration)).then((e=>{var r;return null===(r=t.onComplete)||void 0===r||r.call(t,e),e}))}))}hideOutline(t={}){return this._options.showOutline=!1,this._withData((()=>{var e;return null===(e=this._renderState)||void 0===e?void 0:e.run(et("outline",this._character,"number"==typeof t.duration?t.duration:this._options.strokeFadeDuration)).then((e=>{var r;return null===(r=t.onComplete)||void 0===r||r.call(t,e),e}))}))}updateDimensions({width:t,height:e,padding:r}){if(void 0!==t&&(this._options.width=t),void 0!==e&&(this._options.height=e),void 0!==r&&(this._options.padding=r),this.target.updateDimensions(this._options.width,this._options.height),this._character&&this._renderState&&this._hanziWriterRenderer&&this._positioner){this._hanziWriterRenderer.destroy();const t=this._initAndMountHanziWriterRenderer(this._character);this._renderState.overwriteOnStateChange((e=>t.render(e))),t.render(this._renderState.state),this._quiz&&this._quiz.setPositioner(this._positioner)}}updateColor(t,e,r={}){var o;let n=[];const h=f((()=>"radicalColor"!==t||e?e:this._options.strokeColor)());this._options[t]=e;const l=null!==(o=r.duration)&&void 0!==o?o:this._options.strokeFadeDuration;return n=n.concat(it(t,h,l)),"radicalColor"!==t||e||(n=n.concat(it(t,null,0))),this._withData((()=>{var t;return null===(t=this._renderState)||void 0===t?void 0:t.run(n).then((t=>{var e;return null===(e=r.onComplete)||void 0===e||e.call(r,t),t}))}))}quiz(t={}){return this._withData((async()=>{this._character&&this._renderState&&this._positioner&&(this.cancelQuiz(),this._quiz=new ht(this._character,this._renderState,this._positioner),this._options={...this._options,...t},this._quiz.startQuiz(this._options))}))}cancelQuiz(){this._quiz&&(this._quiz.cancel(),this._quiz=void 0)}setCharacter(t){return this.cancelQuiz(),this._char=t,this._hanziWriterRenderer&&this._hanziWriterRenderer.destroy(),this._renderState&&this._renderState.cancelAll(),this._hanziWriterRenderer=null,this._withDataPromise=this._loadingManager.loadCharData(t).then((e=>{if(!e||this._loadingManager.loadingFailed)return;this._character=function(symbol,t){const e=z(t);return new E(symbol,e)}(t,e),this._renderState=new S(this._character,this._options,(t=>r.render(t)));const r=this._initAndMountHanziWriterRenderer(this._character);r.render(this._renderState.state)})),this._withDataPromise}_initAndMountHanziWriterRenderer(t){const{width:e,height:r,padding:o}=this._options;this._positioner=new B({width:e,height:r,padding:o});const n=new this._renderer.HanziWriterRenderer(t,this._positioner);return n.mount(this.target),this._hanziWriterRenderer=n,n}async getCharacterData(){if(!this._char)throw new Error("setCharacter() must be called before calling getCharacterData()");return await this._withData((()=>this._character))}_assignOptions(t){const e={...Mt,...t};return t.strokeAnimationDuration&&!t.strokeAnimationSpeed&&(e.strokeAnimationSpeed=500/t.strokeAnimationDuration),t.strokeHighlightDuration&&!t.strokeHighlightSpeed&&(e.strokeHighlightSpeed=500/e.strokeHighlightDuration),t.highlightCompleteColor||(e.highlightCompleteColor=e.highlightColor),this._fillWidthAndHeight(e)}_fillWidthAndHeight(t){const e={...t};if(e.width&&!e.height)e.height=e.width;else if(e.height&&!e.width)e.width=e.height;else if(!e.width&&!e.height){const{width:t,height:r}=this.target.getBoundingClientRect(),o=Math.min(t,r);e.width=o,e.height=o}return e}_withData(t){if(this._loadingManager.loadingFailed)throw Error("Failed to load character data. Call setCharacter and try again.");return this._withDataPromise?this._withDataPromise.then((()=>{if(!this._loadingManager.loadingFailed)return t()})):Promise.resolve().then(t)}_setupListeners(){this.target.addPointerStartListener((t=>{this._quiz&&(t.preventDefault(),this._quiz.startUserStroke(t.getPoint()))})),this.target.addPointerMoveListener((t=>{this._quiz&&(t.preventDefault(),this._quiz.continueUserStroke(t.getPoint()))})),this.target.addPointerEndListener((()=>{var t;null===(t=this._quiz)||void 0===t||t.endUserStroke()}))}}$t._loadingManager=null,$t._loadingOptions=null,e.default=$t}.call(this,r(43))}}]);